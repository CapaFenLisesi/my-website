---
layout: default
feijoa: true
title: 8 Linking corresponding 3D models | Thesis
file: thesis/linking-lods.html
lang: en
mathjax: true
---

<div class="container">
	<div class="page-header">
		<h1>8 Linking corresponding 3D models</h1>
	</div>
	<div class="row">
		<div class="col-md-9">
			<p class="text-justify">
				 Chapter <a href="extrusion.html">6</a> and <a href="incremental-construction.html">7</a> presented in detail two low-level construction algorithms for \(n\)D objects, both of which operated on level of individual primitives. These are valuable in their own right, but in order to ease the use of higher-dimensional operations in practice, it is necessary to develop high-level operations based on them which can actually be used by practitioners. This chapter thus describes at a conceptual level how one such high-level operator can be defined, which creates a 4D representation from a series of existing 3D representations at different levels of detail. 
			</p>
			<p class="text-justify">
				 The chapter starts by introducing some background in <a href="#se:linking-background">&sect;8.1</a>, explaining the motivation behind such an operation and covering the principles of linking operations with 2D/3D objects. <a href="#se:linking-methodology">&sect;8.2</a> describes four linking schemes that can be used to construct 4D models from a set of 3D objects, discussing the advantages and disadvantages of each method in terms of their feasibility in practice and of the properties that the 4D model would have. <a href="#se:linking-examples">&sect;8.3</a> presents several use cases to demonstrate how the different schemes result in objects with different characteristics, where the best scheme can be considered to be application-dependent. <a href="#se:concrete-example">&sect;8.4</a> shows a concrete example in detail, implementing a use case that combines most of the linking schemes from <a href="#se:linking-methodology">&sect;8.2</a>. <a href="#se:linking-conclusions">&sect;8.5</a> concludes the chapter with a discussion of the further possibilities of this method. 
			</p>
			<p class="text-justify">
				 Most of this chapter is based on the paper:
			</p>
			{% imbiber pubs/phd.bib one:15ijgi noimg %}
			<p class="text-justify">
				 <h2 id="se:linking-background">8.1 Motivation and background</h2> 
			</p>
			<p class="text-justify">
				 3D city models of the same region are often created at multiple levels of detail (LODs). For instance, in the CityGML standard [<a href="bibliography.html#CityGML2">Gr&ouml;ger et al., 2012</a>] five discrete LODs are defined (<a href="modelling-background.html#fig:citygml-filip">Figure 3.23</a>), which range from the 2D footprint of the building up to a representation where the windows, doors and walls and even indoor objects are all modelled in detail. This allows a user to choose the most appropriate LOD for a given application, balancing the better results that are obtainable using more detailed models with the higher computational requirements that are necessary to obtain them [<a href="bibliography.html#Biljecki14">Biljecki et al., 2014b</a>]. 
			</p>
			<p class="text-justify">
				 However, the creation of these models is a complex task that needs to be performed continuously, as 3D city models need to be kept up to date [<a href="bibliography.html#Zlatanova04">Zlatanova and Holweg, 2004</a>; <a href="bibliography.html#Kolbe05">Kolbe et al., 2005</a>]. Given the large size and complexity of current 3D city models, it can be very beneficial to have incremental updates to a model which affect only a building and its immediate surrounding area [<a href="bibliography.html#Dollner06">D&ouml;llner et al., 2006</a>]. These can take place as buildings and other city objects (e.g. roads, utility infrastructure, city furniture, etc.) are built, modified and destroyed. 
			</p>
			<p class="text-justify">
				 In order to apply such incremental update processes to 3D city models at multiple LODs, links between related objects are crucial. Given an object at a certain LOD, links usually point to its incident and adjacent objects at the same LOD (i.e.  the topological relationships that are most common in GIS), as well as to its <em>corresponding</em> objects at other LODs, even when these objects are of different dimension (e.g. when a thin polyhedron in a higher LOD is collapsed to a polygon in a lower LOD). These links can then be used to propagate changes to other LODs [<a href="bibliography.html#vanOosterom10">van Oosterom and Stoter, 2010</a>] or to apply consistency checks to new or newly altered objects [<a href="bibliography.html#Groger11a">Gr&ouml;ger and Pl&uuml;mer, 2011b</a>], among other operations that are part of a robust update process. 
			</p>
			<p class="text-justify">
				 In theory, a series of LODs might be derived from an automatic generalisation process [<a href="bibliography.html#Weibel97">Weibel, 1997</a>] and thus the exact correspondences between objects can be already known, but as discussed in <a href="modelling-background.html#se:modelling-scale">&sect;3.4</a>, fully automatic 3D generalisation is very complex and has not yet been achieved in practice. The different LODs of a model are therefore usually acquired independently, collected with different techniques, often for different purposes, and thus the resulting representations do not necessarily have easy-to-identify correspondences. The same object can be slightly displaced at different LODs, an object can be an aggregate of other objects (think of a terraced house: either each house is individually represented as a volume or one single volume is used for the whole row), or can be modelled in an entirely different way. In fact, as shown in <a href="#fig:bksep" id="fig:bksepref">Figure 8.1</a>, it is possible that there are no common geometries (i.e.  0-, 1-, 2-, or 3-cells with the same geometry) across a series of models at different LODs.       
			</p>
			<p class="text-justify">
				 In order to join multiple separate representations, stored as independent datasets, it is therefore first necessary to find the correspondences between (equivalent) objects at different LODs. As described in 2D by <a href="bibliography.html#Hampe03">Hampe et al. [2003]</a>, when an automatic generalisation process is used, the objects can be directly linked as they are being generalised. Otherwise, the correspondences must be inferred. In 2D, they are usually inferred using <em>map matching</em> methods, which can take into account the geometry [<a href="bibliography.html#Veltkamp01">Veltkamp and Hagedoorn, 2001</a>], topology and semantics of and between the objects [<a href="bibliography.html#Devogele96">Devogele et al., 1996</a>]. <a href="bibliography.html#Devogele96">Devogele et al. [1996]</a> does this in three steps: (1) manually finding correspondences between semantic classes; (2) resolving conflicts; and (3) matching objects using geometry, topology and semantics. <a href="bibliography.html#Zhang14">Zhang et al. [2014]</a> matches features by computing a compatibility coefficient, derived from the similarity in their geometry and that of their neighbours. 
			</p>
			<p class="text-justify">
				 After the correspondences have been found, the corresponding representations of an object are linked together. These links across LODs usually take the form of common IDs at the 2D or 3D object level. However, more advanced linking structures developed for this exact purpose do exist and are often used in 2D&mdash;some of these were mentioned in <a href="modelling-background.html#se:modelling-scale">&sect;3.4</a>: hierarchical planar subdivisions [<a href="bibliography.html#Filho95">Filho et al., 1995</a>], multi-scale partitions [<a href="bibliography.html#Rigaux95">Rigaux and Scholl, 1995</a>], nested maps [<a href="bibliography.html#Plumer97">Pl&uuml;mer and Gr&ouml;ger, 1997</a>] and topological generalised area partitioning trees [<a href="bibliography.html#vanOosterom05">van Oosterom, 2005</a>]. 
			</p>
			<p class="text-justify">
				 <h2 id="se:linking-methodology">8.2 Suggested methodology and current issues</h2> 
			</p>
			<p class="text-justify">
				 The methods used to identify correspondences between 2D objects and the data structures used to store these correspondences, mentioned in <a href="#se:linking-background">&sect;8.1</a>, do not readily extend to higher dimensions. While map matching methods can identify (to a limited extent) the correspondences between 2D or 3D objects, they do not take into account the lower-dimensional correspondences between the 0D&ndash;2D cells bounding them. Linking corresponding objects using only common IDs at the 2D or 3D object level is similarly problematic, as it is difficult to store complex correspondence relationships, such as an aggregation of multiple objects into one [<a href="bibliography.html#Biljecki14">Biljecki et al., 2014b</a>], or those connecting the points, line segments and polygons on the boundary of corresponding 2D or 3D objects. 
			</p>
			<p class="text-justify">
				 Based on the higher-dimensional data structures presented in <a href="nd-modelling.html">Chapter 4</a>, this section presents a sketch of a dimension-independent approach. By considering the LOD of a model as a fully independent dimension in the geometric sense [<a href="bibliography.html#vanOosterom10">van Oosterom and Stoter, 2010</a>; <a href="bibliography.html#Paul11">Paul et al., 2011</a>; <a href="bibliography.html#Stoter12">Stoter et al., 2012a</a>], it is possible to store all topological relationships between any related objects across all LODs. A set of connected 2D polygons at multiple LODs are modelled as a single 3D polyhedron<a href="#fn117" id="fnref117"><sup>117</sup></a>, as is shown in <a href="#fig:bk" id="fig:bkref">Figure 8.2</a>, and a set of connected 3D polyhedra at multiple LODs are modelled as a single 4D <em>polychoron</em>. Notably, the correspondences between equivalent objects across LODs thus become geometric primitives, making it possible to perform geometric operations with them (e.g. extracting an intermediate LOD for visualisation purposes) or to attach attributes to them (e.g. the meaning of these correspondences), just as is done to other geometric primitives.
			</p>
			<p class="text-justify">
				 In the specific case of a 4D (3D space+LOD) model, a set of 4D objects is modelled as a 4D cell complex embedded in 4D space, where there is an additional LOD axis \(l\) and a point in 4D space is defined by a tuple of coordinates \((x,y,z,l)\). It is worth noting that this implies that the LOD axis should be properly parametrised, defining quantifiable values for every fixed LOD in a model, or alternatively a function that does so. 
			</p>
			<p class="text-justify">
				 The 4D space thus defined is filled with a set of non-overlapping polychora, in which a 3D object (e.g. a building) at <em>all</em> of its different LODs is represented as a single 4D object. This 4D object is bounded by a set of volumes, two of them being the object at its lowest and highest LOD, and several lateral ones formed by filling the space between corresponding faces across LODs. When a 3D cross-section is extracted from it (<a href="slicing.html">Chapter 9</a>), these respectively correspond to the volumes and bounding faces of an extracted 3D model. 
			</p>
			<p class="text-justify">
				 A 4D model is constructed from a series of existing LODs of a 3D city model in three steps:
				 <ol>
				 	<li>identifying corresponding 0D&ndash;3D cells;</li>
				 	<li>linking them by creating 1D&ndash;4D cells connecting them;</li>
				 	<li>using the incremental construction algorithm of <a href="incremental-construction.html">Chapter 7</a> to build a 4D cell complex using all 0D&ndash;4D cells.</li>
				 </ol>
			</p>
			<p class="text-justify">
				 This section describes various methods to identify corresponding cells in different LODs of a 3D object (<a href="#ss:identification">&sect;8.2.1</a>), and then presents four linking schemes to construct a 4D model (<a href="#ss:linkingrules">&sect;8.2.2</a>). As <a href="#se:linking-examples">&sect;8.3</a> demonstrates, the 4D cells created by the linking schemes are used to construct 4D cell complexes with different properties and shapes. 
			</p>
			<p class="text-justify">
				 <h3 id="ss:identification">8.2.1 Step 1: Identifying corresponding cells in 3D models</h3>
			</p>
			<p class="text-justify">
				 Constructing a 4D model from a sequence of 3D models largely depends on the identification of the corresponding 0-, 1-, 2-, and 3-cells between these 3D models. The aim of this identification is to create a mapping between the 3D models that preserves the topological relationships between the elements in the models so as to create a valid 4D model. 
			</p>
			<p class="text-justify">
				 Considering 3D models at different LODs, this identification will often result in matching cells of different dimensions, commonly with some cells in the 3D model at the highest LOD being matched to cells of lower dimension in the 3D model at the lowest LOD . Also, these correspondences will often not result in a one-to-one mapping: groups of adjoining cells in one model, most often in the one at the highest LOD, will commonly be matched to a single cell in the other model. 
			</p>
			<p class="text-justify">
				 The identification of matching cells should be done using a combination of the following, arguably in order of preference: 
			</p>
			<ul style="list-style-type: none;">
				<li>
					<p class="text-justify">
						<strong>Attributes</strong> Using the semantic information stored in the cells, when it is available. For instance, matching two cells that are known to be equivalent through the use of IDs, or if knowledge is kept during the generalisation process, matching a cell with one that is known to be a simplified version of it.
					</p>
				</li>
				<li>
					<p class="text-justify">
						<strong>Topology</strong> When there is an isomorphism between two cells (<a href="operations-background.html#ss:operations-maps">&sect;5.1.1</a>) that additionally preserves all the topological relationships between them (such as the facet/ridge comparisons used in <a href="incremental-construction.html">Chapter 7</a>), the isomorphism between two cells already gives a matching between them, although it might be important to check that the isomorphism is compatible with the matching of the other cells in the model and with some geometric constraints (e.g. a maximum distance between matched cells). Relevantly and as used elsewhere in this thesis, <a href="bibliography.html#Gosselin11">Gosselin et al. [2011]</a> describe how to whether two cells or maps are isomorphic in any dimension. Another more complex possibility is using subgraph isomorphism on unmatched portions of a generalised map [<a href="bibliography.html#Eppstein99">Eppstein, 1999</a>]. The latter option should lead to partial matches and thus better results, but this problem is known to be NP-complete and so it is unlikely to be applicable to large datasets.
					</p>
					<p class="text-justify">
						 Another relevant way to use topology is to use the topological relationships between cells in order to iteratively infer matchings for the cells that remain unmatched after applying some other algorithm [<a href="bibliography.html#Hampe03">Hampe et al., 2003</a>]. Such a case is explained more concretely in the example of <a href="#fig:shape" id="fig:shaperef">Figure 8.5</a>. 
					</p>
				</li>
				<li>
					<p class="text-justify">
						 <strong>Geometry</strong> Using geometric computations, such as those based on computing similarity metrics, simply matching unmatched cells in one model to their nearest neighbour in another model, or attempting to minimise the Earth Mover&rsquo;s Distance (EMD) [<a href="bibliography.html#Rubner98">Rubner et al., 1998</a>] between them. It is however important to compute these matches using constraints that generally preserve the relative positions and topological relationships between the cells. For instance, a greedy algorithm could match cells iteratively, cascading these matches to adjacent cells (in all models) or rejecting matches that would violate a geometric or topological constraint.
					</p>
				</li>
			</ul>
			<p class="text-justify">
				 Another possibility to assist when matching cells is to allow <strong>splitting</strong> an \(i\)-cell into multiple \(i\)-cells by adding cells of lower dimensions in a manner that does not alter the geometry of the cell. This effectively loosens the requirement that two cells be isomorphic by modifying their topology, creating a one-to-one mapping between the two cells. For instance, a face can be split into multiple faces by adding a vertex in its interior and creating edges that link it to some of the vertices of the face<a href="#fn118" id="fnref118"><sup>118</sup></a>. 
			</p>
			<p class="text-justify">
				 <strong>Holes</strong> deserve a special mention, as they can also be used to decide how to match cells. When holes (of any dimension) are present at a higher LOD but disappear at the immediate lower LOD, they can be handled appropriately by collapsing them to a nearby vertex such that they do not create any geometric intersections between the cells. Another option would be to create an additional point at an appropriate location in the lower LOD<a href="#fn119" id="fnref119"><sup>119</sup></a> where it can be collapsed. When holes are present in multiple LODs, they should be handled essentially as if they were independent cells, either matching them directly, splitting them, or collapsing parts of them to match each other. 
			</p>
			<p class="text-justify">
				 <h3 id="ss:linkingrules">8.2.2 Step 2: Linking corresponding cells</h3>
			</p>
			<p class="text-justify">
				 Based on the matches that were found between cells, which mathematically define a map between the 3D cell complexes of the 3D models, they are then linked to construct a 4D cell complex. For this, it might be necessary to create or modify 0D&ndash;3D cells in the input cell complexes, as well as to create new 1D&ndash;4D cells that lie <em>between</em> the 0D&ndash;3D cell complexes. The resulting 4D cell complex is then embedded in 4D space by assigning new 4D coordinates for every point. These 4D points are simply the union of all those in the input 3D cell complexes with an appended coordinate that refers to the LOD of their originating model. Four different basic linking schemes are proposed here, which are shown in <a href="#fig:linkingschemes" id="fig:linkingschemesref">Figure 8.3</a>.
			</p>
			<div class="row" id="fig:linkingschemes">
				<div class="col-sm-6 col-xs-6"><img src="figs/linkingscheme1.svg" class="img-responsive" /><p class="small text-center">(a) Simple linking</p></div>
				<div class="col-sm-6 col-xs-6"><img src="figs/linkingscheme3.svg" class="img-responsive" /><p class="small text-center">(b) Unmatched are collapsed</p></div>
				<div class="col-sm-6 col-xs-6"><img src="figs/linkingscheme2.svg" class="img-responsive" /><p class="small text-center">(c) Modification of topology</p></div>
				<div class="col-sm-6 col-xs-6"><img src="figs/linkingscheme4.svg" class="img-responsive" /><p class="small text-center">(d) Matching all to existing</p></div>
				<div class="col-sm-12"><p class="small text-justify">Figure 8.3: The four linking schemes for three LODs of a house, here depicted in 2D. The objects that would obtained by slicing between the LODs can be seen in dashed green contours; the red dashed lines reflect the cells that need to be added and split in order to ensure a valid 3D (2D+LOD) cell complex.<a href="#fig:linkingschemesref">&#8617;</a></p></div>
			</div>
			<p class="text-justify">
				 <h4 id="sss:method1">Method 1: Simple linking of corresponding cells</h4>
			</p>
			<p class="text-justify">
				 Links are constructed between the corresponding cells of an object at two different LODs, and if a cell has no corresponding cell then it is ignored. While this makes it possible to easily construct a 4D cell complex in the cases where all cells in the lower LOD model have a corresponding cell in the higher LOD model, when this is not the case, the result will consist of an incomplete 4D cell complex&mdash;possibly without any 4-cells. 
			</p>
			<p class="text-justify">
				 To ensure a complete one, cells often need to be split (e.g. those separated by the red dotted line in <a href="#fig:linkingschemes" id="fig:linkingschemesref">Figure 8.3a</a>), which can be performed using geometric intersections. While this is possible in 3D and tools are readily available (see for instance <a href="bibliography.html#Granados03">Granados et al. [2003]</a>; <a href="bibliography.html#Hachenberger06">Hachenberger [2006]</a>), the generalisation of this scheme to higher dimensions is not easy in practice since no robust intersection tools in more than 3D are available. Observe that if a 4D cell complex generated using this method is sliced at an intermediate LOD, the result is exactly that of the lower LOD . 
			</p>
			<p class="text-justify">
				 <h4 id="sss:method2">Method 2: Unmatched cells are collapsed to existing ones</h4>
			</p>
			<p class="text-justify">
				 No modifications are made to the 3D models, which is in practice a significant advantage since no complex geometric operations need to be performed and the size of the cell complex will be smaller than that of the one where cells are modified. Instead of geometric operations, unmatched cells in the higher LOD model are linked to nearby cells <em>of a possibly lower dimension</em> in the lower LOD model while preserving certain geometric and topological constraints (e.g. preserving adjacency and incidence between cells<a href="#fn120" id="fnref120"><sup>120</sup></a>). This implies that some cells will be collapsed (e.g. an edge can be mapped to a vertex), and the cells must be linked with care to ensure that a valid 4D cell complex is created (e.g. no two cells should intersect in 4D space). 
			</p>
			<p class="text-justify">
				 For instance, assume that the left eave of the roof of the house in the middle LOD model in <a href="#fig:linkingschemes" id="fig:linkingschemesref">Figure 8.3b</a> has been (arbitrarily) matched to the roof of the low LOD model, with the right eave remaining unmatched as no unmatched cells remain in the low LOD model. In this case, using the knowledge that the roof and right wall are adjacent in the low LOD model but their corresponding cells (respectively the left eave and right wall) are separated by the right eave in the middle LOD model, the right eave can be collapsed to the common vertex lying between the two (upper right). Using such a mapping, the topological relationships between the cells will be preserved, with the exception of those involving the collapsed cells and those incident or adjacent to them. 
			</p>
			<p class="text-justify">
				 When the mapping has faults and the resulting 4D cell complex thus has geometric problems (e.g. intersecting cells), the slicing operation might not have any geometric meaning, but the resulting higher-dimensional model can nevertheless offer other benefits, e.g. database consistency and the knowledge of some of the equivalences between cells. Note that ensuring that cells preserve their topological relationships and form a partitioning of space in 4D is challenging and not fully considered in this thesis. Finally, even if a combinatorially and geometrically valid 4D cell complex is constructed, the 3D object obtained by slicing might not be consistent with those in the real world; notice how the chimney in <a href="#fig:linkingschemes" id="fig:linkingschemesref">Figure 8.3b</a> becomes increasingly smaller and closer to the right eave of the roof because of the way the cells have been linked. 
			</p>
			<p class="text-justify">
				 <h4 id="sss:method3">Method 3: Modifying the topology</h4>
			</p>
			<p class="text-justify">
				 To ensure that there is a mapping between all the cells, it is possible to split or merge cells so that the topology (combinatorial structure) of the objects is identical. For instance, operations like removal and contraction [<a href="bibliography.html#Damiand03">Damiand and Lienhardt, 2003</a>] can be used to simplify the more complex object(s) to make them match the simpler one(s) using an iterative process. On the other direction, it is possible to first identify for every cell in the lower LOD model one or more corresponding cells in the higher LOD model, then split cells in the lower LOD model so that their topology is the same as in the higher LOD model as the one to which it must be linked. 
			</p>
			<p class="text-justify">
				 As an example, considering the lowest LOD in <a href="#fig:linkingschemes" id="fig:linkingschemesref">Figure 8.3c</a>, this implies first finding multiple matches for the roof cells of the lower LOD models, which then need to be split into multiple cells by the insertion of new vertices. For instance, these can be located at the closest location that lies on the matched lower LOD cell for every higher LOD cell. As this example shows, <em>all</em> the representations of an object where this approach is used will result in the same topology. This results in increased storage space and the possibility of degenerate cells e.g. multiple vertices at one location&mdash;something that however does not cause any topological problems. The geometric operations necessary to split cells can be rather intricate as well. Observe that using this method, slicing in <a href="#fig:linkingschemes" id="fig:linkingschemesref">Figure 8.3c</a> results in a different representation of the object: one where it smoothly morphs into the one at lower LOD (e.g. the tip of the roof is slowly lowered as the LOD decreases). 
			</p>
			<p class="text-justify">
				 <h4 id="sss:method4">Method 4: Matching all cells to existing ones</h4>
			</p>
			<p class="text-justify">
				 As is the case with <a href="#sss:method2">Method 2</a>, this method does not require modifying the topology of the objects. The main difference with it is that cells in the higher LOD model are not necessarily collapsed to a lower dimensional cell in the lower LOD model but are instead matched to one or more cells <em>of any dimension</em> while also preserving certain geometric and topological constraints. In <a href="#fig:ls4" id="fig:ls4ref">Figure 8.3d</a>, observe that the tip of the roof of the middle LOD model (a point) is matched to the roof of the lowest LOD (an edge since this is a 2D representation) and that the 2 edges representing the middle-LOD roof are matched to the two corners of the lower-LOD roof (points). Slicing thus creates a truncated roof having 3 edges. This can be achieved by matching all cells that have a clear correspondence first, then attempting to match groups of unmatched cells while preserving the topological relationships between cells. 
			</p>
			<p class="text-justify">
				 For instance, in <a href="#fig:linkingschemes" id="fig:linkingschemesref">Figure 8.3d</a> it is possible to first match the base and walls of the houses in the lower and middle LOD models, as these have exact equivalences. Then, an algorithm could match the remaining vertex and left/right edges in the middle LOD model respectively to the roof edge and left/right vertices. Observe that in this process, the tip of the roof of the middle LOD model (a point) is matched to the roof of the lowest LOD (an edge) and that the two eaves of the roof (edges) are matched to the two corners of the roof (points) in the lowest LOD . Slicing the resulting 4D cell complex creates a truncated roof having 3 edges. The matches for the chimney to other elements in <a href="#fig:linkingschemes" id="fig:linkingschemesref">Figure 8.8</a> are achieved by matching the chimney top to the right eave, and the remaining vertices and edges on its left and right sides respectively to the roof tip and right eave/wall vertices. The result is that while the chimney looses resemblance to reality, it slowly converges to the roof in the middle LOD model. 
			</p>
			<p class="text-justify">
				 <h2 id="se:linking-examples">8.3 Use cases</h2> 
			</p>
			<p class="text-justify">
				 This section presents practical examples that describe the matching and the linking of cells for a few simple 3D models representing the same object(s) at different LODs. 
			</p>
			<p class="text-justify">
				 <h3>8.3.1 Using Method 1: Simple linking</h3>
			</p>
			<p class="text-justify">
				 <a href="#fig:exsimple" id="fig:exsimpleref">Figure 8.4</a> shows an example where two LODs for a building are linked in such a way that only matched cells are involved. First observe that since the two objects are not isomorphic, some cells are not matched (the ones representing the roof of the higher-LOD model). Observe also that the roof of the lower-LOD model has no match in the higher-LOD model. Thus, to construct a 4D cell complex, the flat roof geometry has to be added to the higher-LOD model<a href="#fn121" id="fnref121"><sup>121</sup></a>. Then, the corresponding cells can be linked. Although it is possible to generate this 4D model by generating the \((i+1)\)-cells that connect a pair of corresponding \(i\)-cells and linking all of them together, it is probably easier to extrude one cell complex along the range between the two LODs using the method described in <a href="extrusion.html">Chapter 6</a>. This method already generates the proper combinatorial structure of the 4D model, and the final cell complex can be obtained by simply moving the vertices of the face representing the model at the other LOD so as to match the geometry of the other model at its LOD.  Moreover, when a linear cell complex is used and thus only the vertices are storing the geometry of the model, it is only necessary to move some of the vertices: those in the lowest LOD without a corresponding vertex at the same location in the highest LOD.  
			</p>
			<div class="row" id="fig:exsimple">
				<div class="col-sm-12"><img src="figs/exsimple.svg" class="img-responsive" /></div>
				<div class="col-sm-12"><p class="small text-justify">Figure 8.4: Two LODs of a house simply linked and the intermediate LOD obtained.<a href="#fig:exsimpleref">&#8617;</a></p></div>
			</div>
			<p class="text-justify">
				 <h3>8.3.2 Using Method 2: Collapsing</h3>
			</p>
			<p class="text-justify">
				 <a href="#fig:shape" id="fig:shaperef">Figure 8.5</a> shows an example with a 3D model at two LODs with differing geometry and topology. The 4D model has been obtained by first matching the 2-cells with known correspondences (the left, right, front and back large faces) and inferring that the other faces in the model at the highest LOD (right) should be collapsed based on their adjacency relationships with the matched faces. For example, since the front and right faces are adjacent in the lowest LOD but not in the highest LOD, the two faces between them<a href="#fn122" id="fnref122"><sup>122</sup></a> should be collapsed to their common boundary (i.e.  their intersection: the edge between them). This example also shows that the topological relationships between the cells are nevertheless preserved with the exception of those that involved collapsed cells. The new topological relationships do however connect cells around the former collapsed cells. Note that the 3D model resulting from slicing the 4D model created in this way at an intermediate LOD (middle) will be isomorphic to the model at the highest LOD.  
			</p>
			<div class="row" id="fig:shape">
				<div class="col-sm-12"><img src="figs/shape.svg" class="img-responsive" /></div>
				<div class="col-sm-12"><p class="small text-justify">Figure 8.5: Two LODs of a house with differing geometry and topology are integrated into a 4D model by collapsing cells in the model at the highest LOD.<a href="#fig:shaperef">&#8617;</a></p></div>
			</div>
			<p class="text-justify">
				 <h3>8.3.3 Using Method 3: Modifying the topology</h3>
			</p>
			<p class="text-justify">
				 <a href="#fig:agg" id="fig:aggref">Figure 8.6</a> shows an example of two 3D models being aggregated. In order to create a 4D model from this situation, the topology of the simpler of the two models is modified, splitting the single volume into equal two adjacent ones, effectively resulting in a cell complex that also has four more vertices, four more edges, and four of its faces split into two. Note that the two models are however not isomorphic since the common face of the two houses in the lowest LOD becomes two disconnected faces in the model at the highest LOD, but that if this topological relationship is disregarded, the two models can be correctly matched independently. 
			</p>
			<div class="row" id="fig:agg">
				<div class="col-sm-12"><img src="figs/agg2.svg" class="img-responsive" /></div>
				<div class="col-sm-12"><p class="small text-justify">Figure 8.6: Two LODs of two houses being aggregated are integrated into a 4D model by modifying the topology of the model at the lowest LOD so as to match the topology of the model at the highest LOD.<a href="#fig:aggref">&#8617;</a></p></div>
			</div>
			<p class="text-justify">
				 <h3>8.3.4 Combination of Methods 2 and 3</h3>
			</p>
			<p class="text-justify">
				 <a href="#fig:link1" id="fig:link1ref">Figure 8.7</a> shows a more complex example with three LODs which are linked using a combination of schemes: collapsing and modifying the topology of one of the models. Most of the cells in the highest LOD can be directly matched to cells in the middle LOD, with the exception of those that are part of the chimney. As these comprise a small object, these are simply collapsed to a single point in the middle LOD.  Matching the roof cells in the lowest and middle LODs is however more complex since collapsing it to a point would ignore its adjacency with the body of the house and therefore not preserve its topology. The best solution is therefore to modify the topology of the lowest LOD in order to split the top face of the cubic house (which can be inferred to be a roof based on its attributes) into 4 faces, making the model isomorphic to the middle LOD.
			</p>
			<div class="row" id="fig:link1">
				<div class="col-sm-12"><img src="figs/link1.svg" class="img-responsive" /></div>
				<div class="col-sm-12"><p class="small text-justify">Figure 8.7: Three LODs of a 3D model of a house are integrated into a 4D model by modifying the topology of the model at the lowest LOD and collapsing a part of the model in the highest LOD.<a href="#fig:link1ref">&#8617;</a></p></div>
			</div>
			<p class="text-justify">
				 <h3>8.3.5 Using Method 4: matching to existing cells</h3>
			</p>
			<p class="text-justify">
				 <a href="#fig:link2" id="fig:link2ref">Figure 8.8</a> shows two of the LODs of the previous example, but matches the cells of the roof of the house to existing cells rather than modifying their topology. After attempting to match corresponding cells, the top face in the lowest LOD and the top four faces in the highest LOD remain unmatched. If each top <em>face</em> in the highest LOD is collapsed to the closest top <em>edge</em> in the lowest LOD (i.e.  the edge that forms the bottom of the triangular face in the highest LOD) and the top <em>vertex</em> in the highest LOD (which lies between the faces) is linked to the top <em>face</em> in the lowest LOD, a four-sided pyramid is generated. Slices from it are shown as four trapezoidal faces in the sliced intermediate LOD.  Then, if the top face in the lowest LOD is collapsed to the top vertex of the highest LOD, another four-sided pyramid is generated. A slice from this one is shown as a square face at the top of the sliced intermediate LOD.
			</p>
			<div class="row" id="fig:link2">
				<div class="col-sm-12"><img src="figs/link2.svg" class="img-responsive" /></div>
				<div class="col-sm-12"><p class="small text-justify">Figure 8.8: Two LODs of a 3D model of a house (left and right) are linked despite not being isomorphic, with an intermediate LOD that shows the result of slicing the construction at an intermediate LOD (centre).<a href="#fig:link2ref">&#8617;</a></p></div>
			</div>
			<p class="text-justify">
				 This particular mapping is notable because it correctly preserves all topological relationships between the cells, does not create additional cells at either LOD, and shows that cells are not necessarily only collapsed from higher LODs to lower LODs. Intuitively, the result of this mapping is a set of cells that bound the model along the LOD dimension<a href="#fn123" id="fnref123"><sup>123</sup></a>, so that an \(i\)-cell and a \(j\)-cell that are matched result in a \(k\)-cell lying between them, where \(k = \max(i, j)+1\). Concretely, if for instance a 0-cell (the tip of the roof) is matched to the flat roof (a 2-cell), then the resulting links will create a tetrahedron (a 3-cell). Admittedly, the rules needed to generate such a mapping can be quite complex, but the cell complex generated is identical in size to the equivalent model according to the scheme in <a href="#fig:linkingschemes" id="fig:linkingschemesref">Figure 8.3b</a>. 
			</p>
			<p class="text-justify">
				 <h2 id="concrete-example">8.4 A concrete example</h2> 
			</p>
			<p class="text-justify">
				 In order to show how the linking methods presented in this chapter work in practice, this section shows an implementation of the model from <a href="#fig:link2" id="fig:link2ref">Figure 8.8</a>. It uses CGAL Linear Cell Complexes and the incremental constructor operator described in <a href="incremental-construction.html">Chapter 7</a>. This model was chosen as it uses most of the linking methods discussed in the <a href="#ss:linkingrules">&sect;8.2.2</a>:  the body of the house in both LODs is directly linked (<a href="#sss:method1">Method 1</a>),  the top face of the house in the lower LOD is collapsed to the tip of the roof in the higher LOD (<a href="#sss:method2">Method 2</a>),  and the roof vertices/edges in the lower LOD are connected to existing roof edges/vertices in the higher LOD (<a href="#sss:method4">Method 4</a>). 
			</p>
			<p class="text-justify">
				 First of all, the 17 vertices of the two 3D models are created as 4D points of the form \((x, y, z, l)\). Afterwards, these are first used to define the 35 faces of the model, the faces are used to define the 12 volumes, and the volumes to define the single 4-cell. Notice that these cells not only include faces and volumes within each of the two volumes of the input 3D models, but also include some faces and volumes that lie <em>between</em> the two, i.e.  having bounding vertices, edges and faces from both input 3D models. Excerpts of the code to generate the 4D cell complex are shown in <a href="#fig:code" id="fig:coderef">Figure 8.9</a>.
			</p>
			<div class="row" id="fig:code">
				<div class="col-sm-12"><img src="figs/link1_filled.svg" class="img-responsive" /><p class="small text-center">(a)</p></div>
				<div class="col-sm-12">{% highlight c++ %}
// 2: Left of first house (yellow)
faceLists.push_back(...);
faceLists.back().push_back(vertices[0]);
faceLists.back().push_back(vertices[2]);
faceLists.back().push_back(vertices[6]);
faceLists.back().push_back(vertices[4]);

//21: Back right vertical edge (blue)
faceLists.push_back(...);
faceLists.back().push_back(vertices[3]);
faceLists.back().push_back(vertices[7]);
faceLists.back().push_back(vertices[15]);
faceLists.back().push_back(vertices[11]);

for (int i = 0; i < 35; ++i)
    faces.push_back(
      builder.get_facet_from_vertices(
        faceLists[i].begin(), 
        faceLists[i].end(), false).first);

// 1: Right house (green)
volumeLists.push_back(...);
volumeLists.back().push_back(faces[6]);
volumeLists.back().push_back(faces[7]);
volumeLists.back().push_back(faces[8]);
volumeLists.back().push_back(faces[9]);
volumeLists.back().push_back(faces[10]);
volumeLists.back().push_back(faces[11]);
volumeLists.back().push_back(faces[12]);
volumeLists.back().push_back(faces[13]);
volumeLists.back().push_back(faces[14]);

// 11: Roof from left to right tip (red)
volumeLists.push_back(...);
volumeLists.back().push_back(faces[31]);
volumeLists.back().push_back(faces[32]);
volumeLists.back().push_back(faces[33]);
volumeLists.back().push_back(faces[34]);
volumeLists.back().push_back(faces[5]);

for (int i = 0; i < 12; ++i)
    volumes.push_back(builder.get_cell<3>(
      volumeLists[i].begin(), 
      volumeLists[i].end()).first);

LCC::Dart_handle house4d = builder.get_cell<4>(
  volumes.begin(), volumes.end()).first;
{% endhighlight %}<p class="small text-center">(b) Constructing other cells</p></div>
				<div class="col-sm-12">{% highlight c++ %}
float point_coordinates[][4] = {
    // Left house
    {0, 0, 0, 0}, // 0
    {1, 0, 0, 0}, // 1
    {0, 1, 0, 0}, // 2
    {1, 1, 0, 0}, // 3
    {0, 0, 1, 0}, // 4
    {1, 0, 1, 0}, // 5
    {0, 1, 1, 0}, // 6
    {1, 1, 1, 0}, // 7

    // Right house
    {0, 0, 0, 1}, // 8
    {1, 0, 0, 1}, // 9
    {0, 1, 0, 1}, // 10
    {1, 1, 0, 1}, // 11
    {0, 0, 1, 1}, // 12
    {1, 0, 1, 1}, // 13
    {0, 1, 1, 1}, // 14
    {1, 1, 1, 1}, // 15
    {.5, .5, 1.5, 1} // 16
};

for (int i = 0; i < 17; ++i) {
    points.push_back(Point(4, 
        point_coordinates[i], 
        point_coordinates[i]+4));
    vertices.push_back(
        builder.get_vertex(points[i]));
}
{% endhighlight %}
<p class="small text-center">(c) Coordinates of the 17 vertices</p></div>
				<div class="col-sm-12"><p class="small text-justify">Figure 8.9: Code excerpts that show how vertices are created based on 4D points, faces as cycles of vertices, volumes as sets of faces, and 4-cells as sets of 3-cells. The colours referred to in (b) correspond to the highlighted faces and volumes in (a).<a href="#fig:coderef">&#8617;</a></p></div>
			</div>
			<p class="text-justify">
				 The resulting 4D model was then validated by checking the properties of a valid combinatorial map (<a href="operations-background.html#ss:operations-maps">&sect;5.1.1</a>). In short, these tests involved checking whether the darts (combinatorial simplices) in the map formed correct involutions or partial permutations and whether any darts remained free after the operations. Individual parts of the model (the triangular or square faces and the parallelepiped- or pyramid-shaped volumes) were also validated by verifying that they were isomorphic to similar objects that were known to be valid [<a href="bibliography.html#Gosselin11">Gosselin et al., 2011</a>]. 
			</p>
			<p class="text-justify">
				 <h2 id="se:linking-conclusions">8.5 Conclusions</h2> 
			</p>
			<p class="text-justify">
				 While integrating different LODs of the same 3D object into a single 4D model is generally considered as complex, the linking schemes proposed in this chapter show that it is possible to define high-level methods to connect different 3D models in a relatively simple manner. The linking schemes operate within a framework of three steps: identifying corresponding elements in different LODs, deciding how these should be linked, and finally linking relevant 3-cells into 4-cells using the incremental construction algorithm described in <a href="incremental-construction.html">Chapter 7</a>. 
			</p>
			<p class="text-justify">
				 Using a 4D representation means that it is possible to store not only the standard topological relationships (e.g. incidence and adjacency) between objects in one LOD, but also all the correspondences between equivalent objects of any dimension across LODs, even when corresponding objects are of different dimensions or the correspondences between them are not one-to-one. As these correspondences are modelled as geometric primitives, it is easy to perform geometric operations with them (e.g. extracting an intermediate LOD for visualisation purposes) or to attach attributes to them (e.g. the meaning of these correspondences), just as is done to usual geometric primitives. 
			</p>
			<p class="text-justify">
				 These topological relationships and correspondences can then be used for multiple applications, such as updating and maintaining series of 3D models at different LODs, or testing the consistency of multi-LOD models (e.g. by using similar validity checks as those in <a href="bibliography.html#Groger11">Gr&ouml;ger and Pl&uuml;mer [2011a]</a>). 
			</p>
			<p class="text-justify">
				 The different linking schemes presented in <a href="#ss:linkingrules">&sect;8.2.2</a> yield 4D models having different properties, such as objects that suddenly appear and disappear, gradually change in size or morph into different objects along the fourth dimension. These different types of 4D models can then be useful for different applications. 
			</p>
			<p class="text-justify">
				 The linking schemes described in this chapter are meant for the multi-LOD 3D to 4D case. However, they do have a generic formulation, so they can also be applied to other non-spatial characteristics such as time, enabling them to be used in new applications, such as identifying the motion or change of objects through time. In addition, these schemes are fully dimension-independent, so it is conceivable that they can be applied to linking multiple higher-dimensional models, such as a series of 4D models that reflect a building at different periods of time and at different levels of detail. 
			</p>
			<p class="text-justify">
				 While the transitions between LODs as shown in this chapter are exclusively linear, it is worth noting that this does not necessarily have to be the case. Non-linear transformations can be also be defined (such as by ensuring that a series of LODs forms a \(C^1\) or \(C^2\) continuous shape) and their corresponding geometries can be either stored in more complex non-linear embeddings of a combinatorial map or discretised as a series of small linear cells that approximate such a shape up to a given \(\epsilon\) threshold. 
			</p>
			<p class="text-justify">
				 Finally, the clearest next step to be followed here is to realise the method sketched in this chapter by analysing the problem in more detail and implementing the required low-level algorithms. While the linking problem has been described here as a monolithic solution, it is more likely that the different methods presented will result in completely different implementations. 
			</p>
		</div>
		<div class="col-md-3">
			<p id="fig:bksep"><img src="figs/bksep.png" class="img-responsive"></p>
			<p class="small text-justify">Figure 8.1: Two LODs of a building footprint. Note that there are no vertices, edges or faces with the same geometry in both LODs, and that many primitives in the higher LOD are equivalent to a single one in the lower LOD.<a href="#fig:bksepref">&#8617;</a></p>
			<p id="fn117" class="small">
				117. Separate polygons might become connected in many different situations, the simplest of which is being joined into a single polygon at one or more LODs.<a href="#fnref117">&#8617;</a>
			</p>
			<p id="fig:bk"><img src="figs/bk.jpg" class="img-responsive"></p>
			<p class="small text-justify">Figure 8.2: Two LODs of a building footprint are stored as a single polyhedron. Note that the correspondences between vertices, edges and faces between the LODs are clearly indicated by the vertical edges and faces, and that holes can be similarly handled with additional edges and faces.<a href="#fig:bkref">&#8617;</a></p>
			<p id="fn118" class="small">
				118. Similar procedures can be defined for the cells of any dimension.<a href="#fnref118">&#8617;</a>
			</p>
			<p id="fn119" class="small">
				119. If this location is in its interior, this is essentially equivalent to a 0D hole.<a href="#fnref119">&#8617;</a>
			</p>
			<p id="fn120" class="small">
				120. This might need to be tested geometrically rather than topologically, as degenerate cells will often be created with this process.<a href="#fnref120">&#8617;</a>
			</p>
			<p id="fn121" class="small">
				121. Otherwise, there could not be a 4-cell in the 4D model as the top of the house would be open and no subset of \(\mathbb{R^4}\) would be enclosed in the model.<a href="#fnref121">&#8617;</a>
			</p>
			<p id="fn122" class="small">
				122. Combinatorially, this involves a search for a path between the front and right faces in the map of the model at the highest LOD.  Such a search would be limited to the nodes representing the aforementioned faces and those representing faces that are <em>not</em> present in the model at the lowest LOD.<a href="#fnref122">&#8617;</a>
			</p>
			<p id="fn123" class="small">
				123. Here is a 3D analogue: considering two arbitrary but parallel &lsquo;top&rsquo; and &lsquo;bottom&rsquo; polygons, an equivalent mapping would create a set of edges and faces connecting them so as to form a closed polyhedron.<a href="#fnref123">&#8617;</a>
			</p>
		</div>
	</div>
	<div class="row">
		<div class="col-sm-3"><p class="text-left"><a href="incremental-construction.html"><i class="fa fa-angle-double-left"></i> 7 Incremental construction</a></p></div>
		<div class="col-sm-3"><p class="text-center"><a href="index.html"><i class="fa fa-angle-double-up"></i> Contents <i class="fa fa-angle-double-up"></i></a></p></div>
		<div class="col-sm-3"><p class="text-right"><a href="slicing.html">9 Extracting information from higher-dimensional models <i class="fa fa-angle-double-right"></i></a></p></div>
	</div>
</div>